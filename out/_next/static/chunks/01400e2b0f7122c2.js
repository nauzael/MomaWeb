(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,27612,e=>{"use strict";let s=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>s],27612)},7233,e=>{"use strict";let s=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},43531,e=>{"use strict";let s=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>s],43531)},98919,e=>{"use strict";let s=(0,e.i(75254).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);e.s(["Shield",()=>s],98919)},24337,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(44215),l=e.i(7233),n=e.i(43531),r=e.i(27612),o=e.i(98919),i=e.i(31278);let d=(0,e.i(75254).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var c=e.i(37727);let x=[{key:"dashboard",label:"Panel Principal"},{key:"bookings",label:"Reservas"},{key:"experiences",label:"Experiencias"},{key:"customers",label:"Clientes"},{key:"reports",label:"Reportes"},{key:"settings",label:"Configuración"}];function m(){let[e,m]=(0,t.useState)([]),[p,u]=(0,t.useState)(!0),[h,b]=(0,t.useState)(!1),[g,f]=(0,t.useState)(!1),[y,j]=(0,t.useState)({permissions:[]}),[v,N]=(0,t.useState)(""),[k,w]=(0,t.useState)(""),[C,S]=(0,t.useState)(""),[E,A]=(0,t.useState)(!1);(0,t.useEffect)(()=>{P()},[]);let P=async()=>{try{let e=await (0,a.fetchApi)("admin/roles/index.php");e&&(m(e),e.length>0&&!C&&S(e[0].id))}catch(e){console.error("Error fetching roles:",e)}finally{u(!1)}},R=async()=>{if(!y.name)return alert("El nombre es requerido");try{let e={id:y.id,name:y.name,description:y.description,permissions:y.permissions||[]};await (0,a.fetchApi)("admin/roles/upsert.php",{method:"POST",body:JSON.stringify(e)}),b(!1),j({permissions:[]}),P()}catch(e){alert("Error al guardar: "+e.message)}},M=async e=>{if(confirm("¿Estás seguro? Esto podría afectar a usuarios existentes."))try{await (0,a.fetchApi)("admin/roles/delete.php",{method:"POST",body:JSON.stringify({id:e})}),P()}catch(e){alert("Error al eliminar: "+e.message)}},T=async e=>{e.preventDefault(),A(!0);try{await (0,a.fetchApi)("admin/users/create",{method:"POST",body:JSON.stringify({email:v,password:k,role_id:C})}),alert("Usuario creado exitosamente con el rol asignado."),f(!1),N(""),w("")}catch(e){alert("Error: "+e.message)}finally{A(!1)}};return p?(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)(i.Loader2,{className:"w-8 h-8 animate-spin mx-auto text-moma-green"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-[#1a1a1a]",children:"Roles y Permisos"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("button",{onClick:()=>f(!0),className:"bg-stone-100 text-stone-600 px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 hover:bg-stone-200 transition-all",children:[(0,s.jsx)(d,{className:"w-4 h-4"})," Asignar Usuario"]}),(0,s.jsxs)("button",{onClick:()=>{j({permissions:[]}),b(!0)},className:"bg-[#061a15] text-white px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 hover:opacity-90 transition-all",children:[(0,s.jsx)(l.Plus,{className:"w-4 h-4"})," Nuevo Rol"]})]})]}),(0,s.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-stone-100 shadow-sm flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-bold text-lg text-[#1a1a1a] flex items-center gap-2",children:[(0,s.jsx)(o.Shield,{className:"w-4 h-4 text-moma-green"}),e.name]}),(0,s.jsx)("p",{className:"text-sm text-stone-400 mb-2",children:e.description||"Sin descripción"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.permissions.includes("all")?(0,s.jsx)("span",{className:"bg-moma-green/10 text-moma-green px-2 py-0.5 rounded text-xs font-bold",children:"Acceso Total"}):e.permissions.map(e=>(0,s.jsx)("span",{className:"bg-stone-100 text-stone-500 px-2 py-0.5 rounded text-xs font-bold capitalize",children:x.find(s=>s.key===e)?.label||e},e))})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>{j(e),b(!0)},className:"px-3 py-1.5 text-xs font-bold bg-stone-100 rounded-lg hover:bg-stone-200",children:"Editar"}),"Admin"!==e.name&&(0,s.jsx)("button",{onClick:()=>M(e.id),className:"px-3 py-1.5 text-xs font-bold bg-red-50 text-red-500 rounded-lg hover:bg-red-100",children:(0,s.jsx)(r.Trash2,{className:"w-4 h-4"})})]})]},e.id))}),g&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-3xl p-8 w-full max-w-lg shadow-2xl relative",children:[(0,s.jsx)("button",{onClick:()=>f(!1),className:"absolute top-4 right-4 p-2 text-stone-400 hover:bg-stone-100 rounded-full",children:(0,s.jsx)(c.X,{className:"w-5 h-5"})}),(0,s.jsxs)("h3",{className:"text-xl font-black mb-6 flex items-center gap-2",children:[(0,s.jsx)(d,{className:"w-6 h-6 text-moma-green"}),"Asignar Nuevo Usuario"]}),(0,s.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold uppercase text-stone-400 mb-1",children:"Email"}),(0,s.jsx)("input",{type:"email",value:v,onChange:e=>N(e.target.value),className:"w-full bg-stone-50 border-none rounded-xl px-4 py-2.5 text-sm font-bold focus:ring-2 focus:ring-moma-green outline-none",placeholder:"usuario@moma.com",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold uppercase text-stone-400 mb-1",children:"Contraseña"}),(0,s.jsx)("input",{type:"password",value:k,onChange:e=>w(e.target.value),className:"w-full bg-stone-50 border-none rounded-xl px-4 py-2.5 text-sm font-bold focus:ring-2 focus:ring-moma-green outline-none",placeholder:"••••••••",minLength:6,required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold uppercase text-stone-400 mb-1",children:"Rol Asignado"}),(0,s.jsx)("select",{value:C,onChange:e=>S(e.target.value),className:"w-full bg-stone-50 border-none rounded-xl px-4 py-2.5 text-sm font-bold focus:ring-2 focus:ring-moma-green outline-none",children:e.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,s.jsxs)("button",{type:"submit",disabled:E,className:"w-full py-3 rounded-xl font-bold bg-[#061a15] text-white hover:opacity-90 shadow-lg mt-4 flex items-center justify-center gap-2 disabled:opacity-50",children:[E?(0,s.jsx)(i.Loader2,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(d,{className:"w-4 h-4"}),"Crear y Asignar"]})]})]})}),h&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-3xl p-8 w-full max-w-lg shadow-2xl",children:[(0,s.jsx)("h3",{className:"text-xl font-black mb-6",children:y.id?"Editar Rol":"Crear Nuevo Rol"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold uppercase text-stone-400 mb-1",children:"Nombre del Rol"}),(0,s.jsx)("input",{type:"text",value:y.name||"",onChange:e=>j({...y,name:e.target.value}),className:"w-full bg-stone-50 border-none rounded-xl px-4 py-2.5 text-sm font-bold focus:ring-2 focus:ring-moma-green outline-none",placeholder:"Ej: Editor de Ventas"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold uppercase text-stone-400 mb-1",children:"Descripción"}),(0,s.jsx)("input",{type:"text",value:y.description||"",onChange:e=>j({...y,description:e.target.value}),className:"w-full bg-stone-50 border-none rounded-xl px-4 py-2.5 text-sm focus:ring-2 focus:ring-moma-green outline-none",placeholder:"Breve descripción..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold uppercase text-stone-400 mb-2",children:"Permisos (Pestañas Visibles)"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3",children:x.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-xl border border-stone-100 cursor-pointer hover:bg-stone-50 transition-colors",children:[(0,s.jsx)("div",{className:`w-5 h-5 rounded-md border flex items-center justify-center transition-colors ${(y.permissions||[]).includes(e.key)?"bg-moma-green border-moma-green text-white":"border-stone-300 bg-white"}`,children:(y.permissions||[]).includes(e.key)&&(0,s.jsx)(n.Check,{className:"w-3 h-3"})}),(0,s.jsx)("input",{type:"checkbox",className:"hidden",checked:(y.permissions||[]).includes(e.key),onChange:()=>{var s;let t;return s=e.key,void((t=new Set(y.permissions||[])).has(s)?t.delete(s):t.add(s),j({...y,permissions:Array.from(t)}))}}),(0,s.jsx)("span",{className:"text-sm font-bold text-stone-600",children:e.label})]},e.key))})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-8",children:[(0,s.jsx)("button",{onClick:()=>b(!1),className:"flex-1 py-3 rounded-xl font-bold text-stone-500 hover:bg-stone-100",children:"Cancelar"}),(0,s.jsx)("button",{onClick:R,className:"flex-1 py-3 rounded-xl font-bold bg-moma-green text-white hover:opacity-90 shadow-lg shadow-moma-green/30",children:"Guardar Rol"})]})]})})]})}e.s(["default",()=>m],24337)}]);