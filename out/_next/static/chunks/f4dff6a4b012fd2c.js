(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,27612,e=>{"use strict";let r=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>r],27612)},69074,e=>{"use strict";let r=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>r],69074)},59606,e=>{"use strict";let r,t,a,n,l;var i=e.i(43476),o=e.i(71645),s=e.i(57688),d=e.i(18566),c=e.i(69074),u=e.i(31278),m=e.i(27612);function h(e,r){if("function"==typeof e)return e(r);null!=e&&(e.current=r)}var p=Symbol.for("react.lazy"),f=o[" use ".trim().toString()];function g(e){var r;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===p&&"_payload"in e&&"object"==typeof(r=e._payload)&&null!==r&&"then"in r}var y=((l=o.forwardRef((e,r)=>{let{children:t,...a}=e;if(g(t)&&"function"==typeof f&&(t=f(t._payload)),o.isValidElement(t)){var n;let e,l,i=(n=t,(l=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(l=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),s=function(e,r){let t={...r};for(let a in r){let n=e[a],l=r[a];/^on[A-Z]/.test(a)?n&&l?t[a]=(...e)=>{let r=l(...e);return n(...e),r}:n&&(t[a]=n):"style"===a?t[a]={...n,...l}:"className"===a&&(t[a]=[n,l].filter(Boolean).join(" "))}return{...e,...t}}(a,t.props);return t.type!==o.Fragment&&(s.ref=r?function(...e){return r=>{let t=!1,a=e.map(e=>{let a=h(e,r);return t||"function"!=typeof a||(t=!0),a});if(t)return()=>{for(let r=0;r<a.length;r++){let t=a[r];"function"==typeof t?t():h(e[r],null)}}}}(r,i):i),o.cloneElement(t,s)}return o.Children.count(t)>1?o.Children.only(null):null})).displayName="Slot.SlotClone",r=l,(t=o.forwardRef((e,t)=>{let{children:a,...n}=e;g(a)&&"function"==typeof f&&(a=f(a._payload));let l=o.Children.toArray(a),s=l.find(x);if(s){let e=s.props.children,a=l.map(r=>r!==s?r:o.Children.count(e)>1?o.Children.only(null):o.isValidElement(e)?e.props.children:null);return(0,i.jsx)(r,{...n,ref:t,children:o.isValidElement(e)?o.cloneElement(e,void 0,a):null})}return(0,i.jsx)(r,{...n,ref:t,children:a})})).displayName="Slot.Slot",t),v=Symbol("radix.slottable");function x(e){return o.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===v}var b=e.i(7670);let j=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,w=b.clsx;var N=e.i(47163);let C=(a="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",n={variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}},e=>{var r;if((null==n?void 0:n.variants)==null)return w(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:t,defaultVariants:l}=n,i=Object.keys(t).map(r=>{let a=null==e?void 0:e[r],n=null==l?void 0:l[r];if(null===a)return null;let i=j(a)||j(n);return t[r][i]}),o=e&&Object.entries(e).reduce((e,r)=>{let[t,a]=r;return void 0===a||(e[t]=a),e},{});return w(a,i,null==n||null==(r=n.compoundVariants)?void 0:r.reduce((e,r)=>{let{class:t,className:a,...n}=r;return Object.entries(n).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...l,...o}[r]):({...l,...o})[r]===t})?[...e,t,a]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)}),U=o.forwardRef(({className:e,variant:r,size:t,asChild:a=!1,...n},l)=>(0,i.jsx)(a?y:"button",{className:(0,N.cn)(C({variant:r,size:t,className:e})),ref:l,...n}));U.displayName="Button";var E=e.i(44215);function R({initialImages:e,onUpload:r,onDelete:t}){(0,d.useRouter)();let[a,n]=(0,o.useState)(e),[l,h]=(0,o.useState)(!1),[p,f]=(0,o.useState)(""),g=(0,o.useRef)(null);(0,o.useEffect)(()=>{n(e)},[e]);let y=async e=>{let t=e.target.files;if(!t||0===t.length)return;h(!0);let a=0,n=0,l=[];for(let e=0;e<t.length;e++){f(`${e+1}/${t.length}`);let i=t[e];try{let e="image/heic"===i.type||"image/heif"===i.type||i.name.toLowerCase().endsWith(".heic")||i.name.toLowerCase().endsWith(".heif"),t=await new Promise((r,t)=>{if(e){let e=URL.createObjectURL(i),a=new window.Image;a.onload=()=>{URL.revokeObjectURL(e);let n=document.createElement("canvas"),l=a.width,i=a.height;(l>3840||i>3840)&&(l>i?(i=Math.round(3840*i/l),l=3840):(l=Math.round(3840*l/i),i=3840)),n.width=l,n.height=i;let o=n.getContext("2d");o?.drawImage(a,0,0,l,i),n.toBlob(e=>{e?r(e):t(Error("Canvas toBlob failed for HEIC"))},"image/webp",.8)},a.onerror=()=>{URL.revokeObjectURL(e),t(Error("HEIC image load failed. Your browser may not support HEIC files."))},a.src=e}else{let e=new FileReader;e.onload=e=>{let a=new window.Image;a.onload=()=>{let e=document.createElement("canvas"),n=a.width,l=a.height;(n>3840||l>3840)&&(n>l?(l=Math.round(3840*l/n),n=3840):(n=Math.round(3840*n/l),l=3840)),e.width=n,e.height=l;let i=e.getContext("2d");i?.drawImage(a,0,0,n,l),e.toBlob(e=>{e?r(e):t(Error("Canvas toBlob failed"))},"image/webp",.8)},a.onerror=()=>t(Error("Image load failed")),a.src=e.target?.result},e.onerror=()=>t(Error("FileReader failed")),e.readAsDataURL(i)}}),o=new FormData;o.append("files",t,`${i.name.split(".")[0]}.webp`);let s=await r(o);s.success?(a++,s.warning&&l.push(`${i.name}: ${s.warning}`)):(n++,l.push(`${i.name}: ${s.error}`))}catch(e){console.error(`Upload error for ${i.name}:`,e),n++,l.push(`${i.name}: ${e.message||"Unknown error"}`)}}h(!1),f(""),g.current&&(g.current.value=""),0===n||(a>0?alert(`Uploaded ${a} images. Failed: ${n}.
Errors:
${l.join("\n")}`):alert(`Failed to upload images.
Errors:
${l.join("\n")}`))},v=async(e,r)=>{if(confirm("Are you sure you want to delete this image?"))try{let a=await t(e,r);a.success?n(r=>r.filter(r=>r.id!==e)):alert(a.error||"Failed to delete image")}catch(e){console.error("Delete error:",e),alert("An error occurred during deletion")}};return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-stone-900",children:"Manage Gallery Images"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("input",{type:"file",accept:"image/*,.heic,.heif",multiple:!0,className:"hidden",ref:g,onChange:y,disabled:l}),(0,i.jsx)(U,{onClick:()=>g.current?.click(),disabled:l,className:"bg-moma-green text-stone-900 hover:bg-moma-green/90",children:l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),p?`Uploading ${p}...`:"Uploading..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.Upload,{className:"w-4 h-4 mr-2"}),"Upload Images"]})})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[a.map(e=>(0,i.jsxs)("div",{className:"group relative aspect-square bg-stone-100 rounded-lg overflow-hidden border border-stone-200",children:[(0,i.jsx)(s.default,{src:(0,E.getImageUrl)(e.url.replace("/gallery/","/gallery/thumbs/")),alt:e.alt_text||"Gallery image",fill:!0,sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 25vw, 15vw",className:"object-cover transition-transform group-hover:scale-105"}),(0,i.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,i.jsx)(U,{variant:"destructive",size:"icon",onClick:()=>v(e.id,e.url),className:"scale-90 hover:scale-100 transition-transform",children:(0,i.jsx)(m.Trash2,{className:"w-4 h-4"})})})]},e.id)),0===a.length&&(0,i.jsxs)("div",{className:"col-span-full h-40 flex flex-col items-center justify-center text-stone-500 border-2 border-dashed border-stone-200 rounded-lg",children:[(0,i.jsx)("p",{children:"No images in the gallery yet."}),(0,i.jsx)("p",{className:"text-sm",children:"Upload images to see them here."})]})]})]})}function $(){let[e,r]=(0,o.useState)([]),[t,a]=(0,o.useState)(!0),n=async()=>{try{let e=await (0,E.fetchApi)("gallery/index.php");r(e.images||[])}catch(e){console.error("Failed to load gallery images:",e)}finally{a(!1)}};(0,o.useEffect)(()=>{n()},[]);let l=async e=>{try{let r=await (0,E.fetchApi)("gallery/create.php",{method:"POST",body:e});return n(),r}catch(e){return console.error("Upload error:",e),{success:!1,error:e.message}}},s=async(e,r)=>{try{return await (0,E.fetchApi)("gallery/delete.php",{method:"POST",body:JSON.stringify({id:e})}),n(),{success:!0}}catch(e){return console.error("Delete error:",e),{success:!1,error:e.message}}};return t?(0,i.jsx)("div",{className:"p-12 text-center text-stone-500",children:"Cargando galería..."}):(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-heading font-bold text-stone-900",children:"Galería Infinita"}),(0,i.jsx)("p",{className:"text-stone-500 mt-2",children:"Administra las imágenes que aparecen en la sección de galería de la página principal."})]})}),(0,i.jsx)("div",{className:"bg-white p-6 rounded-2xl shadow-xs border border-stone-200",children:(0,i.jsx)(R,{initialImages:e,onUpload:l,onDelete:s})})]})}e.s(["default",()=>$],59606)}]);