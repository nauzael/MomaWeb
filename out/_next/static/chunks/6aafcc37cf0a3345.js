(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,27612,e=>{"use strict";let r=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>r],27612)},69074,67881,e=>{"use strict";let r,t,a,n,l,i=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>i],69074);var o=e.i(43476),s=e.i(71645);function d(e,r){if("function"==typeof e)return e(r);null!=e&&(e.current=r)}var c=Symbol.for("react.lazy"),u=s[" use ".trim().toString()];function m(e){var r;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===c&&"_payload"in e&&"object"==typeof(r=e._payload)&&null!==r&&"then"in r}var h=((l=s.forwardRef((e,r)=>{let{children:t,...a}=e;if(m(t)&&"function"==typeof u&&(t=u(t._payload)),s.isValidElement(t)){var n;let e,l,i=(n=t,(l=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(l=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),o=function(e,r){let t={...r};for(let a in r){let n=e[a],l=r[a];/^on[A-Z]/.test(a)?n&&l?t[a]=(...e)=>{let r=l(...e);return n(...e),r}:n&&(t[a]=n):"style"===a?t[a]={...n,...l}:"className"===a&&(t[a]=[n,l].filter(Boolean).join(" "))}return{...e,...t}}(a,t.props);return t.type!==s.Fragment&&(o.ref=r?function(...e){return r=>{let t=!1,a=e.map(e=>{let a=d(e,r);return t||"function"!=typeof a||(t=!0),a});if(t)return()=>{for(let r=0;r<a.length;r++){let t=a[r];"function"==typeof t?t():d(e[r],null)}}}}(r,i):i),s.cloneElement(t,o)}return s.Children.count(t)>1?s.Children.only(null):null})).displayName="Slot.SlotClone",r=l,(t=s.forwardRef((e,t)=>{let{children:a,...n}=e;m(a)&&"function"==typeof u&&(a=u(a._payload));let l=s.Children.toArray(a),i=l.find(f);if(i){let e=i.props.children,a=l.map(r=>r!==i?r:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,o.jsx)(r,{...n,ref:t,children:s.isValidElement(e)?s.cloneElement(e,void 0,a):null})}return(0,o.jsx)(r,{...n,ref:t,children:a})})).displayName="Slot.Slot",t),p=Symbol("radix.slottable");function f(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===p}var g=e.i(7670);let y=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,v=g.clsx;var x=e.i(47163);let b=(a="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",n={variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}},e=>{var r;if((null==n?void 0:n.variants)==null)return v(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:t,defaultVariants:l}=n,i=Object.keys(t).map(r=>{let a=null==e?void 0:e[r],n=null==l?void 0:l[r];if(null===a)return null;let i=y(a)||y(n);return t[r][i]}),o=e&&Object.entries(e).reduce((e,r)=>{let[t,a]=r;return void 0===a||(e[t]=a),e},{});return v(a,i,null==n||null==(r=n.compoundVariants)?void 0:r.reduce((e,r)=>{let{class:t,className:a,...n}=r;return Object.entries(n).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...l,...o}[r]):({...l,...o})[r]===t})?[...e,t,a]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)}),j=s.forwardRef(({className:e,variant:r,size:t,asChild:a=!1,...n},l)=>(0,o.jsx)(a?h:"button",{className:(0,x.cn)(b({variant:r,size:t,className:e})),ref:l,...n}));j.displayName="Button",e.s(["Button",()=>j],67881)},59606,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(57688),n=e.i(18566),l=e.i(69074),i=e.i(31278),o=e.i(27612),s=e.i(67881),d=e.i(44215);function c({initialImages:e,onUpload:c,onDelete:u}){(0,n.useRouter)();let[m,h]=(0,t.useState)(e),[p,f]=(0,t.useState)(!1),[g,y]=(0,t.useState)(""),v=(0,t.useRef)(null);(0,t.useEffect)(()=>{h(e)},[e]);let x=async e=>{let r=e.target.files;if(!r||0===r.length)return;f(!0);let t=0,a=0,n=[];for(let e=0;e<r.length;e++){y(`${e+1}/${r.length}`);let l=r[e];try{let e="image/heic"===l.type||"image/heif"===l.type||l.name.toLowerCase().endsWith(".heic")||l.name.toLowerCase().endsWith(".heif"),r=await new Promise((r,t)=>{if(e){let e=URL.createObjectURL(l),a=new window.Image;a.onload=()=>{URL.revokeObjectURL(e);let n=document.createElement("canvas"),l=a.width,i=a.height;(l>3840||i>3840)&&(l>i?(i=Math.round(3840*i/l),l=3840):(l=Math.round(3840*l/i),i=3840)),n.width=l,n.height=i;let o=n.getContext("2d");o?.drawImage(a,0,0,l,i),n.toBlob(e=>{e?r(e):t(Error("Canvas toBlob failed for HEIC"))},"image/webp",.8)},a.onerror=()=>{URL.revokeObjectURL(e),t(Error("HEIC image load failed. Your browser may not support HEIC files."))},a.src=e}else{let e=new FileReader;e.onload=e=>{let a=new window.Image;a.onload=()=>{let e=document.createElement("canvas"),n=a.width,l=a.height;(n>3840||l>3840)&&(n>l?(l=Math.round(3840*l/n),n=3840):(n=Math.round(3840*n/l),l=3840)),e.width=n,e.height=l;let i=e.getContext("2d");i?.drawImage(a,0,0,n,l),e.toBlob(e=>{e?r(e):t(Error("Canvas toBlob failed"))},"image/webp",.8)},a.onerror=()=>t(Error("Image load failed")),a.src=e.target?.result},e.onerror=()=>t(Error("FileReader failed")),e.readAsDataURL(l)}}),i=new FormData;i.append("files",r,`${l.name.split(".")[0]}.webp`);let o=await c(i);o.success?(t++,o.warning&&n.push(`${l.name}: ${o.warning}`)):(a++,n.push(`${l.name}: ${o.error}`))}catch(e){console.error(`Upload error for ${l.name}:`,e),a++,n.push(`${l.name}: ${e.message||"Unknown error"}`)}}f(!1),y(""),v.current&&(v.current.value=""),0===a||(t>0?alert(`Uploaded ${t} images. Failed: ${a}.
Errors:
${n.join("\n")}`):alert(`Failed to upload images.
Errors:
${n.join("\n")}`))},b=async(e,r)=>{if(confirm("Are you sure you want to delete this image?"))try{let t=await u(e,r);t.success?h(r=>r.filter(r=>r.id!==e)):alert(t.error||"Failed to delete image")}catch(e){console.error("Delete error:",e),alert("An error occurred during deletion")}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-stone-900",children:"Manage Gallery Images"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"file",accept:"image/*,.heic,.heif",multiple:!0,className:"hidden",ref:v,onChange:x,disabled:p}),(0,r.jsx)(s.Button,{onClick:()=>v.current?.click(),disabled:p,className:"bg-moma-green text-stone-900 hover:bg-moma-green/90",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),g?`Uploading ${g}...`:"Uploading..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Upload,{className:"w-4 h-4 mr-2"}),"Upload Images"]})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[m.map(e=>(0,r.jsxs)("div",{className:"group relative aspect-square bg-stone-100 rounded-lg overflow-hidden border border-stone-200",children:[(0,r.jsx)(a.default,{src:(0,d.getImageUrl)(e.url.replace("/gallery/","/gallery/thumbs/")),alt:e.alt_text||"Gallery image",fill:!0,sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 25vw, 15vw",className:"object-cover transition-transform group-hover:scale-105",onError:r=>{let t=r.target;t.src.includes("/thumbs/")&&(t.src=(0,d.getImageUrl)(e.url))}}),(0,r.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,r.jsx)(s.Button,{variant:"destructive",size:"icon",onClick:()=>b(e.id,e.url),className:"scale-90 hover:scale-100 transition-transform",children:(0,r.jsx)(o.Trash2,{className:"w-4 h-4"})})})]},e.id)),0===m.length&&(0,r.jsxs)("div",{className:"col-span-full h-40 flex flex-col items-center justify-center text-stone-500 border-2 border-dashed border-stone-200 rounded-lg",children:[(0,r.jsx)("p",{children:"No images in the gallery yet."}),(0,r.jsx)("p",{className:"text-sm",children:"Upload images to see them here."})]})]})]})}function u(){let[e,a]=(0,t.useState)([]),[n,l]=(0,t.useState)(!0),i=async()=>{try{let e=await (0,d.fetchApi)("gallery/index.php");a(e.images||[])}catch(e){console.error("Failed to load gallery images:",e)}finally{l(!1)}};(0,t.useEffect)(()=>{i()},[]);let o=async e=>{try{let r=await (0,d.fetchApi)("gallery/create.php",{method:"POST",body:e});return i(),r}catch(e){return console.error("Upload error:",e),{success:!1,error:e.message}}},s=async(e,r)=>{try{return await (0,d.fetchApi)("gallery/delete.php",{method:"POST",body:JSON.stringify({id:e})}),i(),{success:!0}}catch(e){return console.error("Delete error:",e),{success:!1,error:e.message}}};return n?(0,r.jsx)("div",{className:"p-12 text-center text-stone-500",children:"Cargando galería..."}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-heading font-bold text-stone-900",children:"Galería Infinita"}),(0,r.jsx)("p",{className:"text-stone-500 mt-2",children:"Administra las imágenes que aparecen en la sección de galería de la página principal."})]})}),(0,r.jsx)("div",{className:"bg-white p-6 rounded-2xl shadow-xs border border-stone-200",children:(0,r.jsx)(c,{initialImages:e,onUpload:o,onDelete:s})})]})}e.s(["default",()=>u],59606)}]);